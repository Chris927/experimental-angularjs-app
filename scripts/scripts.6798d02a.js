"use strict";$(".navbar-nav li a").click(function(){var a=$(".navbar-toggle").is(":visible");a&&$(".navbar-collapse").collapse("hide")}),angular.module("yapApp",["oauth","ngAnimate","ngCookies","ngResource","ngSanitize","ngTouch","ui.router","schemaForm"]).config(["$provide",function(a){a.decorator("$exceptionHandler",["$delegate","ErrorsService",function(a,b){return function(c,d){b.add(c,d),a(c,d)}}])}]).config(["$httpProvider",function(a){a.interceptors.push(["AccessToken",function(a){return{request:function(b){if(-1!=b.url.indexOf(window.Config.itemsUrl)){var c=a.get();c&&(b.headers.Authorization="Bearer "+c.access_token)}return console.log("config.headers",b),b}}}])}]).config(["$stateProvider","$urlRouterProvider",function(a,b){b.otherwise("/"),a.state("home",{url:"/",templateUrl:"views/home.html"}).state("access_token",{template:"",url:"/access_token=:token",controller:["$scope","$rootScope","$location","$state","$timeout","AccessToken",function(a,b,c,d,e,f){var g=c.path().substr(1);console.log("hash",g),f.setTokenFromString(g),e(function(){b.$broadcast("$routeChangeSuccess"),d.go("home")},10)}]}).state("feedback",{url:"/feedback",templateUrl:"views/feedback.html",controller:"FeedbackCtrl",resolve:{config:function(){return window.Config}}}).state("items",{url:"/items",templateUrl:"views/items.html",controller:"ItemsCtrl"}).state("diary",{url:"/diary",templateUrl:"views/diary.html"}).state("diary.index",{url:"/",templateUrl:"views/diary-index.html",controller:"DiaryIndexCtrl"}).state("profile",{url:"/profile",templateUrl:"views/profile.html",controller:"ProfileCtrl"}).state("reportError",{url:"/error",templateUrl:"views/report_error.html",controller:"ReportErrorCtrl"}).state("about",{url:"/about",templateUrl:"views/about.html"})}]),angular.module("yapApp").controller("AboutCtrl",["$scope",function(){}]),angular.module("yapApp").controller("CookieCheckCtrl",["$scope",function(a){a.areCookiesEnabled=!1,document.cookie="__testCookies=x";var b=document.cookie.length;document.cookie="__testCookies=xx";var c=document.cookie.length;c===b+1&&(a.areCookiesEnabled=!0)}]),angular.module("yapApp").controller("NavigationCtrl",["$scope","$rootScope","$log","$location",function(a,b,c,d){a.isActive=function(a){return a===d.path()},b.$on("$stateChangeStart",function(b,d,e){c.log("toState",d,e),a.hideNavigation=d.name.match(/^diary/)?!0:!1})}]),angular.module("yapApp").controller("ErrorFeedbackCtrl",["$scope","$location","ErrorsService",function(a,b,c){a.errors=c.errors(),a.$watch("errors.length",function(b){a.hasErrors=b&&b>0}),a.dismiss=function(){c.clear()},a.showAlert=function(){return"/error"!=b.path()}}]),angular.module("yapApp").controller("ItemsCtrl",["$scope","$log","$state","ProfileService","ItemsResourceService",function(a,b,c,d,e){a.profileName=d.getName()||"(no name)",a.items=e.query(),a.add=function(){var a=new e;a.title="new item",a.uri="http://test.com",a.$save(function(){c.go(c.current,{},{reload:!0})})}}]),angular.module("yapApp").controller("ProfileCtrl",["$scope","$log","$state","ProfileService",function(a,b,c,d){a.data={name:d.getName()},a.update=function(){b.log("update"),d.setName(a.data.name),c.go("home")}}]),angular.module("yapApp").controller("FeedbackCtrl",["$scope","ErrorsService","config",function(a,b,c){a.config=c,a.generateError=function(){throw console.log("generating an error..."),new Error("oops, this is for testing")}}]),angular.module("yapApp").controller("ReportErrorCtrl",["$scope","ErrorsService",function(a,b){a.errors=[],a.emailLink="mailto:chris@uber5.com?subject=Error%20Report&body=testing body";var c="";b.errors().forEach(function(b){a.errors.push(JSON.stringify(b)),c+="Error: "+b.message+"\n",b.error.stack&&(c+="  stack: "+b.error.stack),c+="\n"}),a.emailBody=encodeURIComponent(c),a.$on("$destroy",function(){b.clear()})}]),angular.module("yapApp").factory("ErrorsService",function(){var a=0,b=[];return{add:function(c,d){b.push({error:c,message:c.message,id:++a,cause:d})},errors:function(){return b},clear:function(){b.length=0}}}),angular.module("yapApp").factory("ProfileService",function(){if(!localStorage)throw new Error("local storage not available");return{getName:function(){return localStorage.getItem("name")},setName:function(a){localStorage.setItem("name",a)}}}),angular.module("yapApp").factory("ItemsResourceService",["$resource","ProfileService",function(a){var b=window.Config.itemsUrl;return a(b+"/items",{},{query:{method:"GET",isArray:!0,transformResponse:function(a){var b=angular.fromJson(a);return b.items}}})}]),angular.module("yapApp").controller("SomeFormCtrl",["$scope",function(a){a.model={},a.stuff={type:"object",properties:{name:{type:"string",title:"Your name",minLength:2,description:"How you would like to be referred to in this app"},title:{type:"string","enum":["Mr","Mrs","Dr","NaN"]},email:{type:"string",title:"Your email",pattern:/^[a-zA-Z0-9+._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/,validationMessage:"Please provide a valid email address"}},required:["name","title","email"]},a.stuffy=["title","name","email"],a.update=function(b){console.log("update in SomeFormCtrl, form:",b),a.$broadcast("schemaFormValidate"),b.$valid&&console.log("form is valid")}}]),angular.module("yapApp").controller("DiaryIndexCtrl",["$scope","$log",function(a,b){b.log("DiaryIndexCtrl"),$("#diaryCalendar").fullCalendar({defaultView:"agendaDay",header:!1,height:"auto",columnFormat:"ddd, MMM D",allDaySlot:!1})}]);